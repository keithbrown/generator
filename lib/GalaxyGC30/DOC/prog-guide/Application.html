<HTML>
<HEAD>
<TITLE>Application</TITLE>
</HEAD>

<BODY background="graphics/bg.gif" BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
	<TR>
		<!-- Margin Banner -->
		<TD WIDTH="130"><CENTER><IMG SRC="graphics/logo.gif">
		<IMG WIDTH="130" SRC="graphics/trans.gif"></CENTER></TD>
		<!-- Margin Spacer -->
		<TD ROWSPAN="2" WIDTH="20">
		<IMG WIDTH="20" SRC="graphics/trans.gif"><P></TD>
	
	
		<!-- Title block: DOCUMENT TITLE GOES HERE -->
		<TD VALIGN=TOP><BR>
		     <H1>Application</H1>
		     <BR>
		</TD>

	</TR><TR>
	
		<!-- Navigation Icons & Related Topics -->
		<TD WIDTH="130" VALIGN="TOP" ALIGN="LEFT"> 
		
		<CENTER>
		<BR>
		<IMG WIDTH=6 HEIGHT=21 SRC="graphics/trans.gif">
		
	
  		<!-- These are the Navigation buttons -->
		<A HREF="ActiveX.html"><IMG WIDTH=24 HEIGHT=31 BORDER=0 SRC="graphics/left.gif"></A>
		<A HREF="index.html"><IMG WIDTH=22 HEIGHT=33 BORDER=0 SRC="graphics/up.gif"></A>
		<A HREF="Button.html"><IMG WIDTH=24 HEIGHT=31 BORDER=0 SRC="graphics/right.gif"></A>

		
		<IMG WIDTH=6 HEIGHT=21 SRC="graphics/trans.gif">
		<BR>
  </CENTER>
		</TD>
	
		<!-- Text Area -->
		<TD VALIGN="TOP" ROWSPAN="2">
			<BR>
			
<!---------------------------------->
<!-- Begin actual manual material -->
<!---------------------------------->

 
<A NAME="3204"></A>
Use the <EM><B>application</B></EM> class to manipulate attributes that apply to all the objects in your application, and to manage global state. The application class maintains a pointer to the current application; this is normally the application on whose behalf the current event is being serviced. All application-specific global state is referenced through this object.<P>
Events are routed through the application class, unless the top-level event handler is changed by a developer. Application objects are thus responsible for distributing events to their windows, and the windows are responsible for distributing events to their items. Each application object contains the global state for each Galaxy class that has per-application global variables. Per-application global variables are necessary so that display servers and other exotic programs can be implemented efficiently.<P>
You typically use the standard application object to specify the attributes of your application. Most applications never need the more exotic services provided by the application class. More sophisticated programs may require additional application objects to implement child applications, multiple look-and-feels, or isolated command scopes. Display server programs use the application class extensively to maintain discrete connections to the remote applications that use their services. It is important to note that the programmatic interface to the application class is identical for both kernel-based and distributed libraries; applications do not need to know that they are operating in a distributed environment.<P>
The application class uses the services of the client class to maintain the global state for each application object. There is generally a one-to-one correspondence between application objects and client objects.<P>
The application class registers the event handler of the current application with Galaxy as the top-level event handler. When the current application should change as the result of event dispatch, the receiving application is responsible for changing the current state to the correct application. The default application class implements this behavior, and your classes must implement it also. Note that the default application class is global to the current process, so if class customization is desired, you must clone it first.<P>
A typical application uses the application class only to set its global attributes. Only unusual programs need more than one application object. The application object can be obtained from the application class with <TT><B>GetCurrent</B></TT>. If there is no current application, the application class creates one and returns it. In a distributed environment, a server is responsible for creating application objects for each of its clients. In this case, <TT><B>GetCurrent</B></TT> returns the application object created by the server. Applications should explicitly create application objects only if they need more than one. Application objects implicitly created by the application class or provided by a server need not be destroyed. If a client explicitly creates application objects, it is responsible for destroying them.<P>
<A NAME="3578"><H2> Key Functionality</H2></A>
Use <TT><B>GetCurrent</B></TT> to obtain a pointer to your application object. The current application is set by the application class at startup time and when an event is dispatched. You should not change the current application explicitly.<P>
Use <TT><B>Create</B></TT> or <TT><B>Init</B></TT> to create or initialize a new application object. Since Galaxy provides you with an application object by default, you only need to call these functions if you require multiple application objects. Use Destroy to destroy any application objects you have created explicitly; your default application object is destroyed automatically.<P>
Use <TT><B>SetTitle</B></TT> to change the title of your application. The application title should be a user-readable string that identifies your application (for example, "Looking Glass"). Use <TT><B>SetName</B></TT> to change the name of your application. The application name defaults to the name of your application's executable file (for example, "<TT>lg</TT>"). You can change the application name to specify a name with which the application class should look for your application's resources.<P>
Use <TT><B>SetCursor</B></TT> to change the default cursor for all the windows belonging to your application. Use <TT><B>SetIcon</B></TT> to change the default icon and <TT><B>SetFont</B></TT> to change the default font. Use <TT><B>SetColor</B></TT> to change the default color scheme for your application's windows. Use <TT><B>SetSpace</B></TT> to define commands for all the objects in your application. <P>
Use <TT><B>GetResources</B></TT> to get your application's resource file. This file is located by the Installation class using the name of your application, with the suffix "<TT>vr</TT>" appended (for example, "<TT>lg.vr</TT>"). Refer to the Installation chapter for information about how resource files are located. Use <TT><B>GetPreferences</B></TT> to get your application's preference dictionary in the user resource file. You should store any preferences that are set from within your application in this dictionary. The application class closes both the application and user resource files automatically&#175;you should not attempt to close them yourself.<P>
Use <TT><B>InitWindowIterator</B></TT>, <TT><B>NextWindowIterator</B></TT>, and <TT><B>DestroyWindowIterator</B></TT> to iterate over all the open windows belonging to your application. These functions are often useful during shutdown for closing any documents left open by the user.<P>
<P>



<!---------------------------------->
<!--  End actual manual material  -->
<!---------------------------------->
			
		</TD>
		
	</TR>
	<TR>
   		<!-- Textural Navigation Area -->	
		<TD WIDTH="130" VALIGN="BOTTOM">
	
		<FONT SIZE=-1>

  		<A HREF="ActiveX.html">Previous Chapter</A> | 
		<A HREF="Button.html">Next Chapter</A> <BR>
		<A HREF="index.html">Table of Contents</A> <BR>
		<A HREF="../index.html">Help Map</A> <BR>

		
		<P>
		Need help? <A HREF="../contact-visix.html">Contact Visix</A>.
		<P>
		<A HREF="../copyright.html">Copyright 1996-97</A>, <BR>
		<A HREF="http://www.visix.com/">Visix Software Inc.</A>
		</FONT>
		</TD>
	</TR>
</TABLE>

</BODY>
</HTML>
